{% extends 'base.html.twig' %}

{% block title %}Index
{% endblock %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('css/bootgrid.min.css') }}">
    <link rel="stylesheet" href="{{ asset('css/index.css') }}">
{% endblock %}

{% block body %}

    <nav class="sidebar-navigation">
        <ul>
            <li>
                <a href="#">
                    <i class="fa fa-user-circle"></i>
                    <span class="tooltip">{{ app.user.username }}</span>
                </a>
            </li>
            <li class="active">
                <a href="{{ url('index') }}">
                    <i class="fa fa-list"></i>
                    <span class="tooltip">Liste des participants</span>
                 </a>
            </li>
            <li>
                <a href="#">
                    <i class="fa fa-user-plus"></i>
                    <span class="tooltip">Ajout d'un participant</span>
                 </a>
            </li>
            <li>
                <a href="#">
                    <i class="fa fa-address-book"></i>
                    <span class="tooltip">Liste des utilisateurs</span>
                 </a>
            </li>
            <li>
                <a href="#">
                    <i class="fa fa-cog"></i>
                    <span class="tooltip">Réglages</span>
                 </a>
            </li>
            <li>
                <a href="{{ url('logout') }}">
                    <i class="fa fa-power-off"></i>
                    <span class="tooltip">Déconnexion</span>
                </a>
            </li>
        </ul>
    </nav>

    <div class="navbar-wrapper">

        <div class="container-fluid">

            <div class="title-wrapper">
                    Liste des participants
            </div>

            <div class="table-wrapper">
                <table cellspacing="0" class="table table-condensed table-hover table-striped" id="data-grid">
                    <thead>
                        <tr>
                            <th data-column-id="observ" data-formatter="observ" data-sortable="false" data-width="28px"></th>
                            <th data-column-id="id" data-identifier="true" data-type="numeric" data-searchable="false" data-visible="false">Id</th>
                            <th data-column-id="code" data-width="">Code</th>
                            <th data-column-id="numero" data-width="">Numéro</th>
                            {# <th data-column-id="commands" data-formatter="commands" data-sortable="false" data-width="15%">Actions</th> #}
                            <th data-column-id="status" data-searchable="false" data-visible="false">Status</th>
                        </tr>
                    </thead>
                </table>
            </div>
        </div>
    </div>
{% endblock %}

{% block javascripts %}
    <script src="{{ asset('js/bootgrid.min.js') }}"></script>

    <script>
        $('ul li').on('click', function() {
            $('li').removeClass('active');
            $(this).addClass('active');
        });
    </script>

    <script>
        var grid = $("#data-grid").bootgrid({
            rowCount: [
                1, 2, 3, -1
            ],
            columnSelection: false,
            ajax: true,
            statusMapping: {
                0: "in",
                1: "out",
            },
            requestHandler: function (request) {
                return request;
            },
            url: "{{ path('index') }}",
            formatters: {
                "observ": function(column, row) {
                    if (row.observ)
                        return "<div class=\"pastille\"></div>";
                },
                "commands": function(column, row) {
                    return "<button type=\"button\" class=\"btn btn-xs btn-default command-view\" data-row-id=\"" + row.id + "\"><i class=\"fa fa-eye\"></i></button> " +
                        "<button type=\"button\" class=\"btn btn-xs btn-default command-edit\" data-row-id=\"" + row.id + "\"><i class=\"fa fa-pencil-alt\"></i></button> " + 
                        "<button type=\"button\" class=\"btn btn-xs btn-default command-delete\" data-row-id=\"" + row.id + "\"><i class=\"fa fa-trash-alt\"></i></button>";
                },
            }
        }).on("loaded.rs.jquery.bootgrid", function() {
            grid.find(".command-edit").on("click", function(e) {
                // alert("You pressed edit on row: " + $(this).data("row-id"));
            }).end().find(".command-delete").on("click", function(e) {
                // alert("You pressed delete on row: " + $(this).data("row-id"));
            }).end().find(".command-view").on("click", function(e) {
                // alert("You pressed view on row: " + $(this).data("row-id"));
            });
        });
    </script>
{% endblock %}